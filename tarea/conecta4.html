<!DOCTYPE html>
<html>
    <head>
        <title>Conecta 4</title>
        <meta charset="utf-8">
    </head>
    <style>
        table,
        output {
          box-shadow: .5vh .5vh 2vh .5vh rgba( 0, 0, 0, .5 );
        }
        table {
            width: 90px;
            background-color: royalblue;
        }
        td {
          background: royalblue;
          cursor: default;
        }
        td:before {
          content: "";
          display: block;
          width: 70px;;
          height: 70px;
          border-radius: 50%;
          background: white;
        }
        td.red:before {
          background: red;
        }
        td.yellow:before {
          background: yellow;
        }
        output {
          position: fixed;
          display: none;
          width: 90vh;
          height: 10vh;
          top: 10vh;
          left: 5vh;
          background: white;
          text-align: center;
          font: 5vh sans-serif;
          line-height: 10vh;
          cursor: pointer;
        }
        output:before {
          content: attr( class );
        }
        output.red,
        output.yellow {
        display: block;
        }
    </style>
    <body>
        <script>
            document.write(crearTable());
            function crearTable(){
                var altura = 6;
                var anchura = 7;
                document.write("<table>");
                document.write("<tbody>");
                for(var j = 1 ; j <= altura; j++){
                    document.write("<tr>");
                    for( var i = 1; i <=anchura; i++){
                        document.write("<td>");
                        document.write("</td>");
                    }
                    document.write("</tr>");
                }
                document.write("</tbody>");
                document.write("</table>");
            }
            
        </script>
        <output> Gana!</output>
        <script>            
        var jugador = "red";
        const players = { "red": "yellow", "yellow": "red" },
          output = document.querySelector( "output" ),
          tbody = document.querySelector( "tbody" ),
          rows = tbody.querySelectorAll( "tr" ),
          array = ( n ) => {
            return Array( n ).fill( "" );
          },
          conecta4 = ( strip ) => {
            const resultado = /(?:(red){4}|(yellow){4})/.exec( strip );
            if ( !!resultado ) {
              output.classList.add( resultado[ 1 ] || resultado[ 2 ] );
              return true;
            }
            return false;
          },
          comprobar = () => {
            var strips = {
                  h: [],
                  v: array( 7 ),
                  f: array( 12 ),
                  b: array( 12 )
                },
                strip, color, ganador, dir;
            rows.forEach( ( fila, ri ) => {
              strip = "";
              fila.querySelectorAll( "td" ).forEach( ( cell, ci ) => {
                color = cell.getAttribute( "class" ) || " ";
                strips.b[ ci - ri + rows.length - 1 ] += color;
                strips.f[ ci + ri ] += color;
                strips.v[ ci ] += color;
                strip += color;
              } );
              strips.h.push( strip );
              ganador = ganador || conecta4( strip );
            } );

            console.log( strips ); // game data object

            for ( dir in strips ) {
              if ( !ganador && strips.hasOwnProperty( dir ) ) {
                strips[ dir ].forEach( ( s ) => {
                  ganador = ganador || conecta4( s );
                } );
              }
            }
          },
          dropCounter = ( ci ) => {
            var cell, pc;
            rows.forEach( ( fila ) => {
              if ( !( pc = fila.childNodes[ ci ] ).getAttribute( "class" ) ) {
                cell = pc;
              }
            } );
            if ( cell ) {
              cell.classList.add( jugador = players[ jugador ] );
              comprobar();
            }
          };
        output.addEventListener( "click", () => {
          output.removeAttribute( "class" );
          tbody.querySelectorAll( "td" ).forEach( ( c ) => {
            c.removeAttribute( "class" );
          } );
        }, false );
        tbody.addEventListener( "click", ( evento ) => {
          const trg = evento.target;
          if ( !output.getAttribute( "class" ) && trg.tagName.toLowerCase() === "td" ) {
            dropCounter( trg.cellIndex );
          }
        }, false );
    
        </script>
    </body>
</html>